{"version":3,"file":"index.min.js","sources":["../../src/utils/opt.js","../../src/utils/error.js","../../src/index.js","../../src/object/index.js"],"sourcesContent":["export function create(ctx, x, y, r, color = \"green\") {\n  ctx.beginPath();\n  ctx.arc(x, y, r, 0, Math.PI * 2, false);\n  ctx.fillStyle = color;\n  ctx.fill();\n  ctx.closePath();\n}\n\nexport function clear(ctx) {\n  ctx.clearRect(0, 0, 500, 500);\n}\n\nexport function stepx(x, dx, r) {\n  if (x + dx > (500 - r) || (x + dx < r)) {\n    dx = -dx;\n  }\n  return dx;\n}\n\nexport function stepy(y, dy, r) {\n  if (y + dy > (500 - r) || (y + dy < r)) {\n    dy = -dy;\n  }\n  return dy;\n}\n\nexport function transaction(ctx, move, ...args) {\n  ctx.restore();\n  create(ctx, ...args);\n  move();\n  ctx.save();\n}","export function xyrError(x, y, r) {\n  if (typeof (x) === \"Number\" && typeof (y) === \"Number\" && typeof (z) === \"Number\")\n    throw new Error(\"Must be Number\");\n  if (x < 0 || y < 0)\n    throw new Error(\"Number must be Positive\");\n  if (x < r && y < r)\n    throw new Error(\"Initial position error\");\n}","import { GB, BB } from \"./object\";\nimport \"./style/canvas.css\";\nimport { clear } from \"./utils/opt\";\n\nconst canvas = document.getElementById(\"gm5\");\nconst ctx = canvas.getContext(\"2d\");\n\n// record ball position states\n\n\nlet gb1 = new GB(ctx, 100, 50);\nlet gb2 = new GB(ctx, 80, 40);\nlet bb1 = new BB(ctx, 50, 100, 20, \"red\", 100);\nlet mybb1 = new BB(ctx, 30, 30, 30, \"yellow\", 100);\n\n//simple time\nlet cancelId = null;\n\n// let state = {\n//   gb1: { x: gb1.gb_x, y: gb1.gb_y, r: gb1.gb_r },\n//   gb2: { x: gb2.gb_x, y: gb2.gb_y, r: gb2.gb_r },\n//   bb1: { x: bb1.bb_x, y: bb1.bb_y, r: bb1.bb_r, hp: bb1.hp },\n//   mybb1: { x: mybb1.bb_x, y: mybb1.bb_y, r: mybb1.bb_r, hp: mybb1.hp },\n// };\n\n\n\n\nfunction start() {\n  clear(ctx);\n  gb1.render(ctx);\n  gb2.render(ctx);\n  console.log(\"bb1.hp-------> \", bb1.hp);\n  bb1.hp > 0 ? bb1.render(ctx) : null;\n  mybb1.hp > 0 ? mybb1.render(ctx) : null;\n  bb1.hp > 0 ? bb1.collision(true, bb1, gb1) : null;\n  cancelId = requestAnimationFrame(start);\n}\n\nstart();\n\n// when to end?\n// cancelAnimationFrame(cancelId);\n// hp  100 -> 150 => win\n// hp  100 -> 0  => lose","import {\n  create,\n  clear,\n  stepx,\n  stepy,\n  transaction\n} from \"../utils/opt\";\nimport { xyrError } from \"../utils/error\";\n\n// gb - good ball\nclass GB {\n  constructor(ctx, x = 240, y = 160, r = 10, hp = 100) {\n    xyrError(x, y, r);\n    this.gb_x = x;\n    this.gb_y = y;\n    this.gb_r = r;\n    this.vx = 3;\n    this.vy = -3;\n    this.hp = hp;\n    create(ctx, this.gb_x, this.gb_y, this.gb_r);\n  }\n  move() {\n    this.vx = stepx(this.gb_x, this.vx, this.gb_r);\n    this.vy = stepy(this.gb_y, this.vy, this.gb_r);\n    this.gb_x += this.vx;\n    this.gb_y += this.vy;\n  }\n  render(ctx) {\n    transaction(ctx, this.move.bind(this), this.gb_x, this.gb_y, this.gb_r);\n  }\n}\n\n// mp - magic power\n\n// bb - bad ball\nclass BB {\n  constructor(ctx, x = 240, y = 160, r = 10, color = \"red\", hp = 100) {\n    xyrError(x, y, r);\n    this.bb_x = x;\n    this.bb_y = y;\n    this.bb_r = r;\n    this.vx = -3;\n    this.vy = 3;\n    this.color = color;\n    this.hp = hp;\n    create(ctx, this.bb_x, this.bb_y, this.bb_r, this.color);\n  }\n\n  move() {\n    this.vx = stepx(this.bb_x, this.vx, this.bb_r);\n    this.vy = stepy(this.bb_y, this.vy, this.bb_r);\n    this.bb_x += this.vx;\n    this.bb_y += this.vy;\n  }\n  render(ctx) {\n    transaction(ctx, this.move.bind(this), this.bb_x, this.bb_y, this.bb_r, this.color);\n  }\n  collision(detected, b, target) {\n    if (detected) {\n      this.hp = mutualcollision(b, target);\n      console.log(\"xxxxxx\", this.hp);\n    }\n  }\n}\n\n\nfunction mutualcollision(b, target, state = null) {\n  let bb1 = b;\n  let gb1 = target;\n  let dx2 = Math.pow(gb1.x - bb1.x, 2);\n  let dy2 = Math.pow(gb1.y - bb1.y, 2);\n  let d = Math.sqrt(dx2 + dy2);\n  let hp = bb1.hp;\n  if (d < gb1.r + bb1.r) {\n    console.log(\"撞到惹\");\n    hp = hp - 10;\n    console.log(\"----> after collision \", state.bb1.hp);\n  }\n  console.log(\"dfdfdfdffdfdfdf\", hp);\n  return hp;\n\n}\nexport { GB, BB };\n"],"names":["create","ctx","x","y","r","color","beginPath","arc","Math","PI","fillStyle","fill","closePath","stepx","dx","stepy","dy","transaction","move","restore","args","save","xyrError","z","Error","start","clearRect","render","log","bb1","hp","mybb1","collision","gb1","requestAnimationFrame","GB","gb_x","gb_y","gb_r","vx","vy","this","bind","BB","bb_x","bb_y","bb_r","detected","b","target","state","dx2","pow","dy2","d","sqrt","mutualcollision","getContext","gb2","cancelId"],"mappings":"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"}